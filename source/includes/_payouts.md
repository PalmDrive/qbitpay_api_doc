# Payouts

## Payout

> Object example

```json
{
  "id": "d55ba126aa385c808t8aeb0d",
  "object": "payout",
  "createdAt": "2019-02-23T16:13:12.278Z",
  "amount": 100.1,
  "fee": 1.9,
  "currency": "USD",
  "description": "Payout memo",
  "status": "paid",
  "type": "bankAccount",
  "arrivalDate": "2019-02-25T16:13:12.278Z",
  "externalOrderId": "ba126aa385cd5580",
  "destination": {
    "id": "ba126aa385cd55808t8aeb0d",
    "object": "bankAccount",
    "payerName": "user name",
    "bankAccountNum": "444444444444111",
    "bankRoutingNum": "12345678",
    "bankName": "Chase",
    "bankAddr": "505 Michigan ave, NY, 12345",
    "country": "United States",
    "states": "California",
    "city": "San Francisco",
    "addr": "110 market street",
    "type": "bankAccount",
    "typeLabel": {
      "en": "Bank account",
      "zh": "银行转账"
    }
  }
}
```

Payout object records the data of disbursement action.

field	    |     desc
--------  | -----------
id *string* | ID generated by QbitPay 
object *string* | value is 'payout'
createdAt *string* | timestamp when created in UTC timezone
amount *number* | the amount the user will receive
fee *number* | fee
currency *string* | the currency the user will receive
description *string* | description
status *string* | values: pending(received the payout request), inTransit（in process）, paid（payout completed）, cancelled, failed
type *string* | the type of the payment method that corresponds to destination.type
arrivalDate *string* | the timestamp when the payout status changes to paid
externalOrderId *string* | the order id of the merchant's own system
destination *object* | payment method, see details in paymentMethod

## Create Payout

> Request example

```shell
curl "https://matrix-content-s.ailingual.cn/api/v1/payouts"
  -X POST \
  -u "my_api_key:" \
  -H "Content-Type: application/json" \
  -d '{"amount":100,"currency":"USD","description":"Payout memo","externalOrderId":"ba126aa385cd5580","destination":{...}}' 
```

> Response

```json
{
  "id": "d55ba126aa385c808t8aeb0d",
  "object": "payout",
  "createdAt": "2019-02-23T16:13:12.278Z",
  "amount": 98.1,
  "fee": 1.9,
  "currency": "USD",
  "description": "Payout memo",
  "status": "pending",
  "type": "bankAccount",
  "arrivalDate": "2019-02-25T16:13:12.278Z",
  "externalOrderId": "ba126aa385cd5580",
  "destination": {
    "id": "ba126aa385cd55808t8aeb0d",
    "object": "bankAccount",
    "payerName": "user name",
    "bankAccountNum": "444444444444111",
    "bankRoutingNum": "12345678",
    "bankName": "Chase",
    "bankAddr": "505 Michigan ave, NY, 12345",
    "country": "United States",
    "states": "California",
    "city": "San Francisco",
    "addr": "110 market street",
    "type": "bankAccount",
    "typeLabel": {
      "en": "Bank account",
      "zh": "银行转账"
    }
  }
}
```
Include the data in request body with data type json. QbitPay will send the Webhooks notification every time the payout's status chagnes, including the creation of the payout.

field	|   desc
-------- | --------
amount *REQUIRED number* | the amount the user will receive
currency *REQUIRED string* | the currency the user will receive
destination *REQUIRED object* | the user's account that receive the payout. See details in paymentMethod
description *OPTIONAL string* | description
externalOrderId *OPTIONAL string* | the order id of the merchant's own system

Depends on the different destination type, it needs different fields for the payment method:

type	|   required fields
-------- | --------
bankAccount | payerName, bankAccountNum, bankName, type
wallet | payerName, addr, type
Alipay | payerName, bankAccountNum, type
PayPal | payerName, bankAccountNum, type
Coins.ph | payerName, bankAccountNum, type
GCash | payerName, bankAccountNum, type

### Response

Return a payout object or an error.

## Query Payout

```shell
curl "https://matrix-content-s.ailingual.cn/api/v1/payouts/d55ba126aa385c808t8aeb0d" \
  -u "my_api_key:"
```

> Response

```json
{
  "id": "d55ba126aa385c808t8aeb0d",
  "object": "payout",
  "createdAt": "2019-02-23T16:13:12.278Z",
  "amount": 98.1,
  "fee": 1.9,
  "currency": "USD",
  "description": "Payout memo",
  "status": "pending",
  "type": "bankAccount",
  "arrivalDate": "2019-02-25T16:13:12.278Z",
  "externalOrderId": "ba126aa385cd5580",
  "destination": {
    "id": "ba126aa385cd55808t8aeb0d",
    "object": "bankAccount",
    "payerName": "user name",
    "bankAccountNum": "444444444444111",
    "bankRoutingNum": "12345678",
    "bankName": "Chase",
    "bankAddr": "505 Michigan ave, NY, 12345",
    "country": "United States",
    "states": "California",
    "city": "San Francisco",
    "addr": "110 market street",
    "type": "bankAccount",
    "typeLabel": {
      "en": "Bank account",
      "zh": "银行转账"
    }
  }
}
```

You can also query the payout status manually by the payout's id.

params	|    desc
---- | --------
PAYOUT_ID *REQUIRED string* | the id of payout to query

### Response

Return a payout object or an error.

## Query Payout list

> Request example

```shell
curl "https://matrix-content-s.ailingual.cn/api/v1/payouts" \
  -u "my_api_key:"
```

> Response

```json
{
  "object": "list",
  "url": "/api/v1/payouts?limit=25",
  "data": [
    {
      "id": "d55ba126aa385c808t8aeb0d",
      "object": "payout",
      "createdAt": "2019-02-23T16:13:12.278Z",
      "amount": 98.1,
      "fee": 1.9,
      "currency": "USD",
      "description": "Payout memo",
      "status": "pending",
      "type": "bankAccount",
      "arrivalDate": "2019-02-25T16:13:12.278Z",
      "externalOrderId": "ba126aa385cd5580",
      "destination": {
        "id": "ba126aa385cd55808t8aeb0d",
        "object": "bankAccount",
        "payerName": "user name",
        "bankAccountNum": "444444444444111",
        "bankRoutingNum": "12345678",
        "bankName": "Chase",
        "bankAddr": "505 Michigan ave, NY, 12345",
        "country": "United States",
        "states": "California",
        "city": "San Francisco",
        "addr": "110 market street",
        "type": "bankAccount",
        "typeLabel": {
          "en": "Bank account",
          "zh": "银行转账"
        }
      }
    }
  ]
}
```

Return the list of payouts sorted by createdAt in the descending order

params |	desc
------- | -------
limit *optional int* | page size from 1 to 100. The default value is 10
starting_after *optional string* | the poiner in the pagination indicating from where the first item starts. For example, use the last item's id as the start_after to fetch the next page
ending_before *optional string* | the pointer in the pagination indicating from where the last item ends. For example, use the first item's id as the end_before to fetch the previous page
destination *optional string* | filtered by the associated payment method id
status *optional string* | filtereed by status, available values: pending, inTransit, paid, failed, cancelled


### Response

Return an array of payout objects or an error.

## Payout's Event

> Object example

```json
{
  "id": "fDOuTy95uSiTi",
  "type": "payout.paid",
  "createdAt": "2019-02-25T16:13:12.278Z",
  "object": "event",
  "pendingWebhooks": 0,
  "livemode": true,
  "data": {
    "id": "d55ba126aa385c808t8aeb0d",
    "object": "payout",
    "createdAt": "2019-02-23T16:13:12.278Z",
    "amount": 98.1,
    "fee": 1.9,
    "currency": "USD",
    "description": "Payout memo",
    "status": "pending",
    "type": "bankAccount",
    "arrivalDate": "2019-02-25T16:13:12.278Z",
    "externalOrderId": "ba126aa385cd5580",
    "destination": {
      "id": "ba126aa385cd55808t8aeb0d",
      "object": "bankAccount",
      "payerName": "user name",
      "bankAccountNum": "444444444444111",
      "bankRoutingNum": "12345678",
      "bankName": "Chase",
      "bankAddr": "505 Michigan ave, NY, 12345",
      "country": "United States",
      "states": "California",
      "city": "San Francisco",
      "addr": "110 market street",
      "type": "bankAccount",
      "typeLabel": {
        "en": "Bank account",
        "zh": "银行转账"
      }
    },
  }
}
```
 Event will be triggered when the payout status changes, including the creation. The event object will be sent to the url configured by the customer.

event type	| desc
------- | -------
payout.pending	|  triggered when the payout request is received
payout.inTransition	| triggered when the payout is in proceess
payout.paid	|  triggered when the payout is completed
payout.failed	| triggered when the payout is failed
payout.cancelled	| triggered when the payout is cancelled
